{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "Client Message",
	"description": "Message sent from a client to the server",
	"allOf": [{ "$ref": "/schemas/message.json" }],
	"anyOf": [
		{
			"properties": {
				"type": { "const": "register_slave" },
				"data": {
					"additionalProperties": false,
					"required": ["token", "agent", "version", "name", "id", "plugins"],
					"properties": {
						"token": { "type": "string" },
						"agent": { "type": "string" },
						"version": { "type": "string" },
						"name": { "type": "string" },
						"id": { "type": "integer" },
						"public_address": { "type": "string" },
						"plugins": {
							"type": "object",
							"additionalProperties": { "type": "string" }
						}
					}
				}
			}
		},
		{
			"properties": {
				"type": { "const": "register_control" },
				"data": {
					"additionalProperties": false,
					"required": ["token", "agent", "version"],
					"properties": {
						"token": { "type": "string" },
						"agent": { "type": "string" },
						"version": { "type": "string" }
					}
				}
			}
		},
		{
			"properties": {
				"type": { "const": "resume" },
				"data": {
					"additionalProperties": false,
					"required": ["session_token", "last_seq"],
					"properties": {
						"session_token": { "type": "string" },
						"last_seq": { "type": ["integer", "null"] }
					}
				}
			}
		}
	]
}